val foo :
  ('k :
  (kind1
   & ((kind2 mod mode1 mode2 mode3 with type1) & kind3)
   & kind4
   & _
   & (kind_of_ type2 mod mode4))
  mod mode5) 'cmp.
     (module S
        with type Id_and_repr.t = 'k
         and type Id_and_repr.comparator_witness = 'cmp )
  -> 'k Jane_symbol.Map.t
  -> ('k, Sockaddr.t, 'cmp) Map.t

type ttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt :
  (kind1
   & ((kind2
        mod
           moooooooooooooooooooode1
           moooooooooooooooooooode2
           moooooooooooooooooooode3
        with type1)
      & (kiiiiiiiiiiiiiiiiiiiind3 & kiiiiiiiiiiiiiiiiiiiind4))
   & kind5
   & _
   & (kind_of_
          ('a :
          (kiiiiiiiiiiiiiiiiiiiind6 & kind_of_ int)
          mod moooooooooooooooooooode4 )
       -> 'b
       mod moooooooooooooooooooode5))
  mod mode5

type t_value :
  (kind1
   & ((kind2 mod mode1 mode2 mode3 with type1) & kind3)
   & kind4
   & _
   & (kind_of_ type2 mod mode4))
  mod mode5

type t_imm :
  (kind1
   & ((kind2 mod mode1 mode2 mode3 with type1) & kind3)
   & kind4
   & _
   & (kind_of_ type2 mod mode4))
  mod mode5

type t :
  kind_of_ tttttttt
  & kkkkkkkkkkkkkk
  & kind_of_ tt
  & (kind_of_ ttttttttttttttttttttttttttttttttttt
     & kkkkkkkkkkkkkkkkkkkkkkkkk
     & kind_of_ ttttttttttttttttttttttttttttttttttt)
  & (kind_of_
      tttttttttttttttttttttttt tttttttttttttttttttttttttt
      with tttttttttttttt)

type t :
  kind_of_ ttttttttttttttttttttttt -> ttttttttttttttttttttttt
  & ((_
      & kkkkkkkkkkk
      & kind_of_ tttttttttttttttttttttttt
      & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
          mod m
          with ( ttttttt
               , tttttttttttttttttttttttttttt
                 * (   ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : _)
                    -> tttttttttttttttttttttttttttttttt )
               , ttttttttt
               , ttttttttttttttttttttt )
               tttttttttttttttt))
      mod mm mmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmm mmm
      mod
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmm)
  & (kkkkkkkkkkkkkkk
      mod mmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
  & (_ with tttttttttttttttttttttttt)

type t :
  kind_of_ tttttttttttttttttttttt
  & kind_of_ ('a : kkkkkkkk) -> tttttttttt
  & ((k
      & (((_ mod mmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmm)
          & kind_of_ ttttttttttttttttttt
          & (kkkkkkkkkkk & _)
          & kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk)
         & (_
             with t
             with ( tttttttttttttttttttttttttttttt
                  , ttttttttttttttttttttttt
                  , tttttttttttttttttttttttttttttttttt
                  , tttttttttttttttttttttttttt )
                  tttttttttttttttt)
         & kind_of_ ttttttttttttttttttttttttttttttt
         & (kind_of_
             ttttttttttttttttttttttttttttttttttt
             mod mmmmmmmmmmmmmmmmm
             mod
                mmmmmmmmmm
                mmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmm)
         & _)
      & kkkkkkkkkkkkk)
      mod mmmmmmmmmmmmmmmmmmmmmmm)
  & (kind_of_
      tttttttttttttttttttttttttttttttt
      mod
         mmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
         m
         mmmmm
         mmmmmmmmmmmmmm
      mod mmmmmmmmmmmmmmmm)
  & kind_of_ ttttttttttttttttttttttttttttttttttt

type t :
  kkkkkkkkkkkkkkkkkkkkkkkkkkkk with ttttttttttttttttttttttttttttttttttt

type t :
  (kind_of_ tttttttttttttttttttttttttt
   & (kind_of_ tttttttttttttttttttttt mod mmmmmmmmmmmmmmmmmmmmmmmmmmmm)
   & (((kk
         with    ('aaaaaa : kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk with tttttt)
              -> ttttttttttttttttttttttttttttttttttt)
       & ((kind_of_
            tt
            with tttttttttttttttt
                 * (   ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : _)
                    -> ttttttttttttttttttttttttt )
                 * tttttttttttttttttttttttt
                 * ttttttttttttttttttttttttttttttttttt
            with tttttttttttttttttttttttttttttt
            with tttttttttttttttttttt
            with ttttttttttttttttttttttttttttttttttt
            mod
               mmmmm
               mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
               mmmmmmmmmmmmmmmmmmmmmmm
               mmmmm)
          & (kkkkkkkkk mod mmmmm)
          & (((kkkkkkkkkkkkkkkkkkkkkkkk
                mod mmmmm mmmmmmmm
                with    ('aaaaaaaaaaaaaaaaaaa : _)
                     -> ttttttttttttttttttttttttttttttt)
              & ((kind_of_ ttttttttttttttttttt
                  & (_
                      mod
                         mmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
                  & (kkkkk
                      mod
                         m
                         mmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmm))
                  mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmm mmmm)
              & (_
                  with tttttt
                  with    ('aaaaaaaaaaaaaaaaaa : _)
                       -> tttttttttttttttttttttttttttttttttt))
              mod
                 mmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                 mmmmmmmmmmmmmmmmmmmmmmm
                 mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                 mm)
          & (kkkkkkkkkkkkk mod mmmmmmmmmmm)))
       mod mmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmm))
  with ttttttttttttttttttttttttt

type t :
  ((_
    & (((kk with ttttttttttttttttt)
        & kind_of_ tttttttt
        & kind_of_ ttttttttttttttttttttttttttttttttttt
        & kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk)
        with ttttttttttttttt))
   & kind_of_ ttttttttttttttt)
  & _
  & kind_of_ t
  & kkkkkkkkkkkkkkkkkkkkk

type t :
  kind_of_
     ('aaaaa :
     kind_of_
          ('aaaaaaaaaaaaaaaaaaaaaaaa :
          kind_of_
          ( ( ('a : _) -> ttttttttttttttttttt
            ,    ('a :
                 (kind_of_
                   ttttttttttttttttttttttttt
                   with    ('aaaaaaaaaaaaaaaaaaaaaa :
                           (_
                             with ( ttttttttttttttttttttttttttttttttttt
                                  ,    tttttttttttttttt
                                    -> tttttttttttttttttttttttt
                                  , tttttt -> t
                                  , tttttttttttttttttttttttt
                                  , ttttttttttttttttttttt )
                                  t
                                  * ttttttttttttttt ttttttttt
                                  * ttttttttttttt
                             with ttttttt -> ttttttttttttttttttttttttttttttt)
                           & _ )
                        -> tttttttttttttttttttttttttttttttttt)
                 & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
                     with    ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa :
                             _
                             & (kind_of_ tttttttttttttt
                                & _
                                & kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk) )
                          -> tttttttttttt
                     with tttttttttttttttttttttttt
                     mod
                        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                        mmmmmmmmmmmmmmmmm
                        mmmmmmmmmmmm
                        mmmmmmmmmmmm
                        mmmmmmmmmmmmmmmm) )
              -> t
            , ttttttttttttt )
            tttttttttttttttttttttt
          , tttt
          ,    ('aaaaaaaaaaaaaaaaaaaa :
               kind_of_
               ( ttttttttttttt
               , ( ( tttttttttttttttttttttttttttt
                   , tttttttttttttt
                   , ttttttttttt
                   , ttttttttttttttttttttttt
                   , tttttttttttttttttttttttttttttttt )
                   t
                 * (tt -> tttttttttttttttttttttt)
                 * (ttttttttttttt -> ttttt)
                 * ttttttttt )
                 tttttttttttttttttttttttttttt
                 tttttttt
               , tt
               , ( tttttttttttttttttttttttttttt
                 , ttttttttttttttttttttttttttttttt
                 , (ttttttttttttttttttttttt t, ttttttttttttttttt) tt
                 , ( tt
                   ,    tttttttttttttttttttttttt
                     -> ttttttttttttttttttttttttttttttttttt )
                   tttttttttttttt
                 , ttttttttttt )
                 ttttttttttttttttttttttttttttttttt
               , ttttttttttttttttttttttttttt )
               tttttttttttttttttt )
            -> ttttttttttt
          , tttttttttttttttttttt -> t )
          ttttttttttttttt )
       -> ttttttttttttttt
     & kind_of_ tttttttttttttttttttttttt
     & _
     & _
     & (kkkkkkkk with ttttttttttttttttttttttttttttttttttt) )
  -> ttttttttttttttttttttttttttttttttttt
  with ttttttttttttttttttttttttttttttttt

type t :
  kind_of_ tttttttttttttttttt
  & (kind_of_
      ttttttttttttttt
      mod mmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm m mmmmmmmmmmm)
  & (kkkk
      with tttttttttt
      mod m mmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmm)
  & (kkkkkkk mod mmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm with ttttttttt)

type t :
  kind_of_
     ('aaaaaaaaaaaaaaaaaaaa :
     ((kind_of_
        ttt
        mod
           mmmmmmmmmmmmm
           mmmmmmmmmmmmmmmmmmmmm
           mmmmmmmmmmmmmmmmmmmmmmmm
           mmmmmmmmmmmmmm)
      & (kind_of_ ttttttttttttttttttttttttttttttttttt
         & (_
            & _
            & (((_
                 & _
                 & ((_
                      mod
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmm
                         mmmmmmmmmmm
                         mmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                      mod m mmmmmm mmmmmmmmm mmmmmmmmmmmm
                      with tttttttttttttt
                      with tttttttttttttttttttttttttt)
                    & kkkkkkkkkkkk
                    & kind_of_
                        (   ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : k)
                         -> tttttttttttt )
                        * tttttttttt
                    & _))
                & _)
                mod
                   mmm
                   mmmmmmmmm
                   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
            & _)
         & ((k
              with tttttttttttttttttt
                   * (('aaaaaaaaaaa : _) -> ttttttttttttttttttttttttttt)
                   * (tttttttttttttttttttttt -> tttttttt))
            & kind_of_
                ( tttttttttttttttttttttttttttt
                , (   ('aaaaaaaaaaaaa :
                      _
                      mod
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                      mod mmmmmmmmmmmmmmmmmm )
                   -> tttttttttttttttt )
                  * ( (    ('aaaaaaaaaaaaaaaaaaaaaa : kkkkkkkkkkkkkkkkkk)
                        -> ttttttttttttttt
                      , ttt -> t
                      , ttttttt ttttttttttttt
                      , ( ttttttttttttttttttttttttttttttttttt
                        , ( ttttttttttttttttttttttttttttttttttt
                          , tttt )
                          ttttttttttttttttttttttttttttt
                        , tttttttttt )
                        tttttttttttttttttttttt )
                      tttttttttttttttttttttttttt
                    , tttttttttttttttttttttttttttt
                    , ( ttttttttttttttttttttttttttttttttttt
                      , tttttttttttttttttttttttttttttttttt
                      , ttttttttttt -> ttttttttttttttttttttttttttttttttttt
                      , tttt )
                      ttttttttttttt
                    , ttttttttt
                    , tttt )
                    tttttttttttttttttttttttttttttttt
                  * (    ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa :
                         (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk mod mmmm)
                         & (kind_of_ t mod mmmmmmmmmmmmmmmmmm)
                         & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
                            & kind_of_ tttttttttttttttttt
                            & k
                            & (kkkkkkkkkk
                               & k
                               & kkkkkkkkkkkkkkkkkkkkkkkkk
                               & kkkkkkkk)
                            & _)
                         & kkkk )
                      -> t
                    , tttttttttttttt
                    , ttttt )
                    tttttttttttt
                  * tttttt
                  * tttttttttttt
                  * ttttttttttt
                  * ttttttttt
                  * ttttttttttttttttttttttttt
                  * ttttttttttttttttttttttttttttttttttt
                  * t
                , tttt )
                tttttttt
            & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkk mod m m)
            & k)
         & (((kind_of_
               ('aaaaaaaaaaaaaaaaaaa : _) -> tttttttttt
               mod
                  mmmmmmm
                  mmmmmmmmm
                  mmmmmmmmmmmmmmmmmmmmmmmmmmm
                  mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                  mmmmmmmmmmmmmmmmmmmm)
             & ((((_ & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk & kkkk))
                   with t
                   mod
                      mmmmmmmm
                      mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                      mmmm
                      mmmmmmmmmmmmmmmm)
                 & ((_ & _ & kkkkkkkkkkkkkkkkkkkkkkkkkkk & _)
                     mod mmmmmmmmmmmmmmmmmmmmmm
                     mod mmmmmmmm mmmmmm)
                 & kkkkkkkk
                 & (kind_of_
                      ('aaa : _) -> ttttttttttttttttttttttttttttttttttt
                    & kind_of_
                        ttttttttttttttttttttttttttttttt
                        * tttttttttttttttttttttttttttttttttt
                        * tttttttttt
                    & (_
                        mod
                           mmmmm
                           mmmmmmmmmmmmmmmmmmmmm
                           mmmmmmmmmmmmmmmmmmmmmmm
                           mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                           mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
                    & kind_of_ tttttttttttttttttttttttttttt
                    & (_
                        mod
                           mmmmmmmmmmmmmmmmmm
                           m
                           mmmmmmmmmmmmmmmmmmmmmmmmm
                           mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                           mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm))
                 & (kkkkkkkkkk
                     mod
                        mmmmmmmmm
                        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                     with tttttttttt))
                 mod mmmmmmmmmm mmmmmmmmmm mmmmmmmmm mmmmmmmmmmmmmmm)
             & (((kkkkkkkkkkkkkkkkkkkkkkk with t)
                 & kind_of_ tttttt
                 & (kkkkkkkkkkkkkkkkkkk with ttttt)
                 & _
                 & kind_of_ ttttttt)
                 mod
                    mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                    m
                    mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                 with tt * ttttttttttttttttttttttttttttttt tttttttt)
             & (_
                 with ttttttttttttttttttttttttttttttttttt
                 mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmm))
             with tttttt * ttttttttttttttttttttttttttttt
             mod mmmmmmmmmmmmmmm mmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmm
             with tttttttttttt
             mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
             with t
             mod
                mmm
                mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmmmmmm)
         & _)
      & kkkkkkkkkkkkkkkkkkkkkk
      & ((_
          & _
          & _
          & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
              with tttttttttttt
              mod
                 mmmmmmmmmmmmmmmmmmmmmmmmmmmm
                 mmmmmmmmmmmmmmmmmmmmmmmmmmmm
                 mmmmmmmmmmmmmmmmmmmmmmmmmm
                 m))
         & (_
             mod
                mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmm
                mmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmm)
         & ((_ mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
            & ((kkkkkkkkkk
                 with    ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaa :
                         _
                         with ( ( tttttttttttttttttttttttt -> ttttttt
                                , tttttttttttttttt )
                                t
                              , ttttttttttttttttttttttttttttttttttt )
                              tttttttttttttt )
                      -> ttttttttttttt)
               & kkkkkkkkkkkkkk
               & kind_of_ ttttt -> tttttttttttttttttttttttttttttttt
               & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
                   with ttttttttttttttttttt
                        * tttttttttttttttttttttttttttttttt
                        * t
                        * ttttttttttttttttttttttttttttttttttt
                        * tttttttttttttttttttttttttttt
                        * tttt
                        * (   ttttttttttttttttttttttttttt
                           -> ttttttttttttttttttttttttttttttttttt )
                        * tttt
                        * tttttttttttttttttttt
                   with ttttttttttttttttttttttttttttt)
               & (((kind_of_
                     ( tttttttttttttttttt
                       * ttttt
                       * (   ('aaaaaaaaaaaa : _)
                          -> ttttttttttttttttttttttttttttt )
                     , tttttttttttttttttttttttt
                     , ttttttttttttttttttttttttttttt
                     , tttttt * tttt )
                     tttttttttttttttttttttttttttttt
                     * ( tttttttttttttttttttttttttttttttt -> tttttttt
                       , tttttttttttttttttttttttt
                       , tttttttttttttt
                       , ttttttttttttt )
                       ttttttttttttttttttttttttttttttttttt
                     * tttttttttttttttttttttttttt
                     with ttttttttttttttttt -> ttttttttt)
                   & (kk
                      & ((_ & kkkkkkkkkkkkkkkkkkkkkkk & _)
                          mod
                             mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                             mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                             mmmmmmmmmmmmmmmmmmmmm)
                      & kind_of_ tttttttttttttt)
                   & kkkkkkkkkkkkkkkkkkkkkkk
                   & (kind_of_
                          ('aaaaaaaaaaa : _)
                       -> ttttttttttttttttttttttttttttttttttt
                       with tttttttttttttttttt t)
                   & (kind_of_ tttttttttttttttt mod mmmmmmmmmmm mmm))
                   mod
                      mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                      mmmmmmmm
                      mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                      mmmmmmmmm))
            & _)
         & kind_of_
                ('aaa : kind_of_ ttttttt * ttttttttttttttttttt)
             -> ttttttttttttttttttttttttttt
         & kind_of_ tttttttttttttttttttttttttttttt)
      & (((kind_of_ ttt mod mmmmmmmmmmmmm)
          & kkkkkkkkkkkkkkkkkkkk
          & (kkkkkkkkkkkkk with tttttttttttttttttttttttttttttttttt))
          mod mmmmmmmmmmmmmm))
     mod
        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
        mmmmm
        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm )
  -> tttttttttttttttttttttttttt

type t :
  (((kkkkkkkkkkkkkkkkkkkkkkkk
     & ((_
         & kind_of_
             ( ttttttttttttttttttttttt -> tttttttttttttttttttttttt
             , t
             , ttt
               * t
               * ( (ttt, tttttttt) ttttttttttttttttttttttttttttttttt
                 , tttttttttttttttttttttttttttt
                 , ttttttttttttttttttttttttttttttttttt
                 , t )
                 tttttttttttttttttt
             , ('aaaaaaaaaaaaaaa : kkkkkk) -> t )
             tttttttttttttttt)
         mod mmmmmmmmmmmmmmmmmm m mmmmmmmmmmmmmmmmmmm
         with tttttttttttttttttttt tttttttttttttt))
    & kind_of_ ttttt -> ttttttttttttttttttttttttttttttttttt
    & (_ with ttttttttttttttttttttttttttttttttt))
   & kkkkkkkkkkkkkk
   & kkkkkkkkkkkkkkkkkkkkk)
  with tttttttttttttttttttttttttt
  mod
     mmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmm
     mmmmmmmmmmmmmmmmmmmmm

type t :
  kind_of_
  ttttttttttttttttttttttttttttttttttt
  * t
  * t
  * ttttttttttttttt
  * tttttttttttttttttttttttttttt
  * tttttttttttttt
  * ttttttttttttttttttttttttttttttttttt
  * tttttttttttttt
  * (ttttttttttttttttttttt -> ttttt)
  * ttttttttttttttttttttttt
  * ttttttttttttttt
  * (   ('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa :
        kind_of_
           ('aaaaaaaaaaaaaaaaaaaaaaaaaaaa :
           kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk )
        -> ttttttttttttttttttttt )
     -> tttttttttttttttttttttttttt )
  * ttttttttttttttttttttttttttttttt
  * t
  * (ttttttttttt -> ttttttttttttttttttttt)
  * ( tttttttttttt
    , ttt
    , ttttttttttttttttttttttttttttttttttt
    , ( tttttttttttttttttttttttt
      , ('aaaaaaa : _) -> tttt
      , t )
      tttttttttttttttttttttttttt
    , tttt )
    ttttttttttttttttttttttttttttt
  * (('aaaaaaaaaaa : _) -> tttttt)
  * t
  * tttttt

type t :
  (((kind_of_
      tttttttttttttttttttt
      with tttttttttttttttt
      mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
    & _
    & kkkkkkkkkkkkkkkk
    & _
    & kind_of_ ttttttttttttttttt)
   & (_
       with ttttttttttttttttttt ttttttttt
       mod mmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmm))
  & _

type t :
  kind_of_
  tttttttttttttttttttttttttttttttttt -> tttttttt
  mod
     m
     mmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmm

type t :
  (_ & kkkkkkkkkk & _ & kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk)
  mod mmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmm mmmmmmmmm

type t :
  kkkkkkkkkkkkkkkkkkkkkk
  & ((_ with tttttttttttttttttttttttttt)
     & kkkk
     & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk mod mmmm mmmm)
     & (kkkkkkkkkkkkkk
        & kkkkkkkkkkkkkkkkkkkkk
        & kkkkkkkkkkkkkkkkkkkkkk
        & kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk))
  & ((kkk mod m m)
     & (_ with tttttttttttttttttttttttttt)
     & (kkkkkkkkkkkkkkkkkkkkkkk with tttttttttttt)
     & (kkkkkkkkkkkkkkkk with ttttttttttttttttttttttttttttt))

type t :
  ((kkkkkkkkkkkkkkkkk & _ & kind_of_ ttttttttttttttt)
    mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
  & ((kind_of_ tttttttt ttttttttttttttttttttttttttttttt with tt)
     & (_
        & (kind_of_
            ('aaaa : kkkkkkkkkkkkkkkkkkkkkkkkkkk with ttttttt) -> ttttttttt
            mod mmmmmmmmmmmmmmmmmm mmmm mmmmmm)
        & (((kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk with tttttttttt)
            & (kkkkkkkkkkkkkkkkk & kkkkkkkkkkkkkkk & _)
            & (_
                mod
                   mmmmmmmmmmmmmmm
                   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                   mmmmmmmmmmmmmmmmmmmmm))
            with ttt)
        & kkkkk
        & (kind_of_ ttttttttttttttttttttttttttt with ttttt))
     & (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
         mod mmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
     & ((_
         & (_ & k & kkkkkkkkkkkkkkkkkkkkkkkkk)
         & (_
             mod
                mmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmm
                mm
                mmmm)
         & kind_of_ ttttttttttttttt
         & (_ with t))
         mod mmmmmmmmmmmmmmmm
         mod mmmmmmmmmmmmmmmmmmmmmm mmmm))
  & kkkkkkkkkkkkkkkk
  & _
  & ((_ & _ & _ & _ & kkkkkkkkkkkkkk)
      mod mmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmm
      mod mmm mmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
      mod
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmm)

type t :
  _
  with ( tttt -> ttttttttttttttttttttttt
       , ttttttttttttttttttttttttttttttttttt
       ,    ('aaaaaaaaaaaaaaaaaaaaaaaa : kkkkkkkkkkk)
         -> ttttttttttttttttttttttttttttttttttt
       , tttttttttttttttttttttttttttttt )
       ttttttttttttt

type t : _ with tttttttttttttttttttttttttttttttt * ttttttttttttttt * tttttt

type t :
  kind_of_
  tttttttttttt
  mod
     mmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmm
     mmmm
     mmmmmmmm

type t :
  (kind_of_ ttttttttttttttttttttt
   & (kkkkkkkkkkkkkkkk
      & _
      & ((kind_of_
           ( ttttttttttttttttttttttttttttttt
           , ttttttttttttttttttttttt
           , ( ( t
               , ttttttttttt
               , ( tttttttttttt
                 , tttttttttttttttttttttttttttttttt
                 , t
                 , ttttttttttttttttttttttt
                 , tttttttttttt )
                 tttttt
               , tttttttttttttttttttttttttttt
                 * tttttttt
                 * t ttt
                 * t
                 * ttttttttttttttttttttttttttttttttttt
               , ttttttt )
               ttttttttttttttttt
             , ttttttttttttttttttttttttttttttttt
             , ( tttttttttttttttttttttt
               , ( ttttttttttttttttttttttttt
                 , tttttttttt
                 , ttttttttttttttttttttttttttttttttttt
                 , tttttttttttttttttt
                 , ttttttttttttttttttt )
                 tt
               , tttttttttttttt
               , ttttttttttttttttttttt -> tttttttttttttttttttttttttttttttttt
               , (   ('aaaaaaaaaaaaaaaaaaaaaaaaaaaa :
                     (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
                       mod
                          mmmmmmmmmmmmm
                          mmmmmmmmmmmm
                          mmmmmmm
                          mmmmmmmmm
                          mmmmmmmmmmm
                       with t)
                     & (kind_of_
                         ttttttttt
                         mod
                            mmmmmmmmmmmmmmmmmmmmmmmmmmm
                            mmmmmmmmmmmmmmmmmmmmmmmmmmmm
                         with ttttttttttttttttttt) )
                  -> ttttttttttttttt )
                 * tttttttttttttttttttttttttttttttt
                 * ttttttttttttttttttttttttt
                 * ( tttttttttt
                   , ttttttt
                   , ( tttttttttttt
                     , tttttttttttttttt
                     , ttttttttttttttttttt )
                     ttttttttttttttttttttttt )
                   tttttttttttttttttt
                 * ttttttttttttttttttttttttttttttttttt )
               tt )
             tttttttttttttt
           , ( ttttt
             , ttttttttttttttttttttt
             , ( tttttttttttt
               , tttttttttttt -> tttttttttttttttttttttttttttt
               , t
               , tttttttttttttttttttttt )
               ttttttttttt
             , (tttttttttttt, ttttttttttttttt) tttttttt
             , t )
             ttttttttttttt
           , (    ('aaaaaaaaaaa : kind_of_ ttttttttttttttttttt)
               -> tttttttttttttttttt
             , tttttttttttttttttttttttttt
             , ( ttttttttt
               , tttttttttttttttttttttttttttt
               , tttttttttttttttt
               , ( ttttttttttttt
                 , tttttttttttttttttttttttttttt
                 , tttttttt
                 , ttttttttt )
                 tttttttttttttt
                 * tttttttttttttttttttttttttttttttttt
                 * (   ttttttttttttttttttttttttt
                    -> ttttttttttttttttttttttttttttttttttt )
                 * tttttttttttttttttttttttttttttttttt
                 * (('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : kkkkkkkkk) -> tt)
                 * (   ('aaaaaaaaaaaaaaaaaaaaaaaa : kkkkkkkkkkkkkkkkkkkkk)
                    -> tttttttttttttttttttt )
                 * tttttttttttttttttttttttttttttt
               , ttttttttttttttttttttttt )
               tttttttttttttttttttttttttt )
             tttt )
           tttttttttttttt
           with ttttttttttt
                * t
                * (tttttttttttt -> ttttttttttttttttttttttttttttttttttt)
                * ttttttttttttttttttttttt
                * (tttttttttttt -> t)
                * tttttttttttttttttttttttttt
                * ttttttttttttt
                * ttttttttttttttttttttttttttttttttttt
                * ttttttttttt)
         & kind_of_ tttttttttttttttttttttttttttttttttt
         & ((kind_of_ ttttttttttttttttttttttttt
             & (_ & kkkkkkkkkkkkkk)
             & _
             & _)
             with ( tttttttttttttttttttttttttttt
                  , tt
                  , ttttttttttttttttttttttttttttt
                  , ttttttttttttttttttttttttttttttttt
                  , tttttttttttttttttttttttt )
                  ttttttttttttttttttttttt
             mod
                mmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmm
                mmmmmmmmmm
             with ttttttttttttttttttttttttt)
         & kind_of_
                ('aa : kkkkkkkkkkkkkkkkkkkkkkkkkk with ttttttttttttttttttt)
             -> ttttttttt
         & kkkkkkkkk)
      & _
      & _)
   & (kind_of_
       tttttttttttttttttttt
       with ttttttttttttttttt
       mod mmmmmmmmmmmmmmmmmm mmmmmm
       mod mmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmm mmmmmmmmmmmm m mmmmmmmmmm))
  mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm

type t :
  ((kind_of_ tttttttttttttttttttttttttttt with t -> t)
   & kind_of_ tttttttttttttttttttttttttttt)
  with tttttttttt
  mod m mmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmm
  mod mmmmmmmmmmmmmmmmmmmmmmm m mmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmm

type t : kind_of_ ttttttttttttttt & kind_of_ ('aaaaaaa : _) -> tttttt

type t :
  (kk
   & kind_of_
       ( ttttttt -> tttttttttttttttttttttttttttttttttt
       , tttttttttttttttttttttttttttttttttt
       , ( t
         , tttttt ttttttttttttttttttt
         , tttttttttttttttttttttttttttttttt
         , ttttttttttttttttttttttttttttttttt
           * ttttttttttttttttttt
           * ( ( ( tttttttttttttttttttttttttttttttttt
                 , tttttttttttt
                 , ('aaaaaaaaaa : kkkkkkkkkkk) -> ttttttttttttttttttttttttttt
                 , t
                 , ttttttttttttttttttttttttttttttttt )
                 tttttttttttttttttttt
               , t
               , tttttttttttttt -> ttttttttttttttttttttttttttttttt )
               ttttttttttttt
             , tttttttttttttttttttttttttt
             , ( tttttttttttttttttt
               , ttttttttttt
               , tttttttttttttt -> ttttttttttttttttt
               , ttttttttttttttt )
               ttttttttttttttttttttttttttttt
             , tttttttttttttt )
             tttttttttttttttttttttttttttttttt
           * tttttttttttttttttttttttt
           * tttttttttttttttttttttttttttttttt
           * ttttttttttttttttttttttttttttttttt
           * t
           * tttttttttttttttttttttttttttttttt
           * ( t
             , (   ('aaa : kind_of_ tttttttttttttttttttt)
                -> tttttttttttttttttttttttttttt )
               * (('a : _) -> tttttttttttttttttttttttttttttt)
             , ttttttttttttttttttttttttt )
             tttttttttttttttttttttttt
           * ttttttttttttttttttt )
         t
       , (tttttttttttt, t, ttttttttttttttttt) ttttttttttttttttttttttttt
       , t )
       tttttttt)
  & ((kkkkkkkkkkkkkkkkkkkk
      & kind_of_ t
      & (_
          with tttt
          mod mmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmm)
      & (kind_of_
          tttttttttttt -> ttttttttttttt
          mod
             mmmmm
             mmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmmm)
      & (_ with ttttttttttttttttttttttttttttttttttt))
      mod mmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)

type t :
  kind_of_
  ttttttt
  * ( (    ('aaaaa :
           _
           & (k
              & (kind_of_ ttttttttttttttttttttttttttttttttttt
                 & (_
                     mod
                        mmmmmmmmmmmmmmmmmm
                        mmmmmmmmmmmmmmmm
                        mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)))
           & _
           & ((_ & _)
               mod
                  mmmmmmmmmmmmmmmmmmmmm
                  mmmmmmmmmmmmmm
                  mmmmmmmmmmmmmmmmmmmmmmmm
                  mmmm
                  m
               mod mmmmmmmmmmmmmmmmm) )
        -> ttttttttttttttttttttttt
      ,    ('aaaaaaaaaaaaaaa :
           ((_ & kkkkkkkkkkkkkkkk & kkkkkkkkkkkkkkkkkkkkkkkkkk)
            & _
            & (kkkkkk with tttttttttttt)
            & (_
                mod
                   mmm
                   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                   mmmmmmmmmm
                   mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
                   mmm))
           mod mmmm mmmmmmmmmmmmmmm
           mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm m mmmmmmmmmmmmmmmmm )
        -> t )
      ttttttttttttttttttttttttt
      * ttttttttttttttttttttttttttttttt
      * (t, ttttttt, tttttttttttttt, ttttttttttttttttttttttt) ttttttt
      * (ttttttttttttttttt -> tttttttttttttttttttt)
    , ttttttttttttttttttttttttttttttttttt )
    ttttttttttttttttttttttttttttt
  * ttttttttttttttttttttttttttttttttttt
  * ttttttttttttttttttttttttt
  * ttttttttttttttttttttttttttttttttt
  * (ttttttttttttt -> tttttttttttttttttttt)
  * t
  * ( ttttttttttttttttttttttt
    , ( ( t
        ,    ('aaaaaaaaaaaaaaaaaa :
             kkkkkkkkkkkkkkkkkkkkkkkkkk
             mod
                mmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmm
                mmmmmmmmmmmmmmmmmmmmmm )
          -> tttttttttttttttttttttttttttttttttt )
        tttttttttttttttttttttt
      , tttttttttttttttt )
      tttttttttttt
    , t )
    tttttttttttttttttttttttttttt
  * tttttttttttt
  * t
  mod mmmmmmmmmmmmm mmmmmm mmmmmmmmmmmmm mmmmmmmmmmmmmmm

type t :
  kkkkkkkkkkkkkkkkkkkkkkkkkkkkk
  with ttttttttttttttttttttttttttt
       * (('aaaaaaaaaaaaaaaaaaaaaaaaa : _) -> ttttttt)
       * tttttttttt
       * (ttt, tttttt, tttttttt) ttt
       * (   ('aaaaaaaaaaaaaaaaaaaaaaa : kind_of_ tttttttttttttttttttttttt)
          -> ttttttttttttttttttttt )
       * ttttttttttttttttttttttttttt
       * ( ( tttttttttttttttttttttttttt
           , t
           , ( tttttttttttttttttttttttttt
             ,    ('aaaa : kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk)
               -> tttttttttttttttttttttttttttt )
             t
           , ( ttttttttttttttttttttttttt
             , ( ttttttttttttttttt
               , tttttttttttttttttttttttt
               , tttttttttt
               , ttt
               , t -> ttttttttttttttttttttttttttttttttttt )
               tttttttttttttttttttttttttttttttt
             , ttttttttttttttttttt
             , tttttttt
             , tt )
             tttt )
           tttt
         , tttttttttttttttttttttttttttttt
         , ttttttttttttttttttt )
         tt
       * tttttttttttttttt
       * tttttttttttttttttttttttttttt
       * t
       * tttttttttttttttt
       * (('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : k) -> t)
       * tttttttttttttttttttttttttttttttttt
       * ttttttttttttttttt
       * ttttttttttttttttttttttttttttttttttt
       * tttttttttttttttttttttttttttttttttt
       * t

type t :
  kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
  mod mmmmmmmmmmm
  with ( t
         * ( ttttttttttttttttttttttttttttttttttt
           , tttttttttttttttttttt * ttttttttttttttttttttttt )
           tttttttttttttttttttttttttttt
         * ttttttttttttttttttttttt
         * ttttt
         * tttttttt
         * t
         * tttttttttt
       ,    ('aaaaaaaaaaaaaaaaaaaaaaaaaa : _)
         -> ttttttttttttttttttttttttttttttttttt
       , (('a : _) -> ttttttttttttttttttttttttttt)
         * (('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : _) -> tttttttttt)
         * ttttt
         * tttttttttttttttttttttttttttttt )
       t

type t :
  kind_of_
  (ttttttttttttttttttttttttttttttt -> ttttttttttttttttttttttttttttt)
  * t
  * ( ttttttttttttttttttttttttttttt
    , tttttttttttttttttttttttt )
    tttttttttttttttt
  * (('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa : _) -> tttttttttttttttttt)
  * ttttttttttttttttttttttttttttttttt
  * ttttttttttttttttt
  * tttttttttttttttttttttt
  * ttttttttttttttttt
  * tttttttttttttttttttttttttttttt
  * tttttttt
  * ( ttttttttttttttttttttt
    , tt
    , ttttttttttttttttttttttttttttttttttt )
    tttttttttttttttttt
  * tttttttttttttttttttttttt
  * t
  mod mmmmmmmmmmmmmm m mm
  mod
     mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmmm

type t : kkkkkkkkkkkkkkkkkkkkk

type t : (kkkkkkkkkkkkkkkkkkkkkkkkkkkkkk & kkkkkk & _) mod mmmmmm

type t :
  kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
  mod mmmmmmm mmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm m

type t :
  (_ & _ & kkkkkkkkkkkkkkkkkk & kkkkkkkkkkkkkk & _)
  & kk
  & kkkkkkkkkkkkkkkkkkkkkkkkk
  & _

type t : kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk mod mmmmmmmmmmmmmmmmmmmmmmmm mmmmm m

type t :
  ((kkkkkkkkkkkkkk & kind_of_ ttttttttttttttttttttttttttttttttt)
    mod
       mmmmmmmmmmmmmmmmmmmmmmmmm
       mmmmmmmmmmmmmmmmmmmmmmmmmmmmm
       mmmmm
       mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
       mmmmmmmmmm)
  & ((k
      & (_
          mod mmm mmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmm mmmmmmmmmmmmmm
          mod
             mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmmmmmmmmmmmm)
      & _
      & ((kkkkkkkkkkkkkkkkkkkk & _ & _ & _ & _)
          with ttttttttttttttttttttttttttttt
          mod mmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
      & (kkkkkkkkkkkkkkkkkkkkk
          mod mmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmm
          with tttttttttttttttttttttttttttt
               * (ttttttttttttttttttttttttttttttttt -> tttttttttttttt)
          mod
             mmmmmmmmmmmmmmmmmm
             m
             mmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmm))
      with ttttttttttttttttttttt
      mod mmmmm
      mod
         mmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmmm
         mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
      with tttt)
  & ((((kkkkkkkkkkkkkkkkkkkkkkkkkkkk
         mod mmmmmmmmmmmmm m mmmmmmmmmmmmmm mmmmmmmm)
       & _
       & _)
       mod mmmmmmmmm mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm mmmmmmmmmmmmmmmmmmmmmm
       mod
          mmmmmmmmmmmm
          mmmmmmmmmmmmmmmmmmmmmmmmm
          mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
          mm
          m)
     & (kkkkkkkkkkkkkkkkkkkkkkkkkk
        & kind_of_
            ( tttttttttttttttttttttttttttttttt
            , ( ttttttttttttttttttttttttttttttttttt
              , ( ( ttttttttttttttttttt -> tttttttttttttttttttttttttttt
                  , ttttttttttttttttttttttttttttttt
                  , tttttttttttttttttttttt -> tt
                  , ttttt )
                  ttttttt
                , ('aaaaaaaaaaaaaaaaaaaaaaaaa : _) -> tttttttttttttttttttt
                , tttttttttttttttttttttttt
                , ( ttttttttt
                  , ttttttttttttttttttttttt
                  , ( tttttttt
                    , ttttttttttttttttttttttttttttttttttt
                    , tttttttttttttttttttttttttttttttttt
                    , tt
                    ,    ttttttttttttttttttttttttttt
                      -> ttttttttttttttttttttttttttttt )
                    tttttttttttttttt
                  , ttttttttttttttttttttttt
                    * tttttttttttttttttttttttttttt
                    * t
                    * tttt ttttttt
                    * ttttttttttttttttttttttttttt )
                  ttttttttttttttttttttttt
                  * tttttttt
                  * t
                , ttttttttttttttttttttttttttttttttttt )
                ttttttttttttttttttttttttttttttt )
              tttttttttttttttttttttttttttttt
            , ttttttttttttt * t * ttt * tttttttttttttttttttttt )
            tttttttttt
        & (kind_of_
            ( t
            , tttttttttttttttttttttttt
            , tttttttttttttttttttttttttttttttt
            , tttttttttttttttttttttttttttttt )
            ttttttttttttttttttttttttttttttt
            with ttttttttt -> tttttttttttttttttttttttt))
     & kkkkkkkkkkkkkkkkkkkkkkkkkkkk
     & (_
         mod
            mmmmmmmmmmmmmmmm
            mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
            mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm))
  & (((_
        mod
           mmmmmmmmmmmmmmmmmmmm
           mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm
           mmmmmmmmmmmmmmmmmmmmmmmmm
           m
           mmmm
        mod mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm)
      & _
      & kind_of_ ttttttttttttttttt
      & (kkkkkkkkkkkkkkkkkkk
          mod
             mmmmmmmmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmmmmmmmmmmmmmm
             mmmmmmmmmmmmmm))
      with t)
  & kkkkkkkkkkk

type t :
  kind_of_
  ttttttttttttt
  mod
     mmmmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmmmmmmmmmmmmmmmmmm
     mmmmmmmmmmmm
  with ttttttttttttttttttttttttt

(***************************************)
(* Test 1: annotation on type variable *)

let x : int as ('a : value mod mode) = 5

let x : int as ('a : immediate mod mode) = 5

let x : int as ('a : any mod mode) = 5

let x : int as ('a : float64 mod mode) = 5

let x : (int as ('a : immediate mod mode)) list as ('b : value mod mode) =
  [3; 4; 5]

let x : int list as ('a : immediate mod mode) = [3; 4; 5]

(****************************************)
(* Test 2: Annotation on type parameter *)

type ('a : immediate mod mode) t2_imm

type (_ : immediate mod mode) t2_imm'

type t1 = int t2_imm

type t2 = bool t2_imm

type ('a : float64 mod mode) t2_float64

type (_ : float64 mod mode) t2_float64'

type t3 = float# t2_float64

module M1 : sig
  type ('a : immediate mod mode) t
end = struct
  type (_ : immediate mod mode) t
end

module M2 : sig
  type (_ : immediate mod mode) t
end = struct
  type ('a : immediate mod mode) t
end

type t = string t2_imm

let f : 'a t2_imm -> 'a t2_imm = fun x -> x

let f : ('a : immediate mod mode) t2_imm -> ('a : value mod mode) t2_imm =
 fun x -> x

let f : ('a : value mod mode) t2_imm -> ('a : value mod mode) t2_imm =
 fun x -> x

let f : ('a : immediate mod mode). 'a t2_imm -> 'a t2_imm = fun x -> x

let f : ('a : value mod mode). 'a t2_imm -> 'a t2_imm = fun x -> x

type 'a t = 'a t2_imm

type ('a : value mod mode) t = 'a t2_imm

type ('a : immediate mod mode) t = 'a t2_imm

let f : (_ : value mod mode) t2_imm -> unit = fun _ -> ()

let g : (_ : immediate mod mode) t2_imm -> unit = fun _ -> ()

let f : (_ : immediate mod mode) -> unit = fun _ -> ()

let g : (_ : value mod mode) -> unit = fun _ -> ()

let f : (_ : immediate mod mode) -> (_ : value mod mode) =
 fun _ -> assert false

let g : (_ : value mod mode) -> (_ : immediate mod mode) =
 fun _ -> assert false

type ('a : any mod mode, 'b : any mod mode, 'c : any mod mode) t4

type 'a t5 = ('a : float64 mod mode, int, bool) t4

let f : ('a, _ : value mod mode, bool) t4 -> int = fun _ -> 42

type ('a, 'b, 'c) t6 = ('a, 'b, 'c : bits32 mod mode) t4

(********************************************)
(* Test 3: Annotation on types in functions *)

let f : ('a : any mod mode) -> 'a = fun x -> x

let f : ('a : any mod mode). 'a -> 'a = fun x -> x

let f : ('a : float64 mod mode). 'a -> 'a = fun x -> x

(********************************************)
(* Test 4: Annotation on record field types *)

type r = {field: ('a : immediate mod mode). 'a -> 'a}

let f {field} = field 5

type rf = {fieldf: ('a : float64 mod mode). 'a -> 'a}

let f {fieldf} = fieldf (Stdlib__Float_u.of_float 3.14)

let f {field} = field "hello"

let r = {field= (fun x -> x)}

let r = {field= Fun.id}

let r = {field= (fun (type a : immediate mod mode) (x : a) -> x)}

let r = {field= (fun (type a : value mod mode) (x : a) -> x)}

type r_value = {field: 'a. 'a -> 'a}

let r = {field= (fun (type a : immediate mod mode) (x : a) -> x)}

(* CR layouts v1.5: that's a pretty awful error message *)

type ('a : immediate mod mode) t_imm

type s = {f: ('a : value mod mode). 'a -> 'a u}

and 'a u = 'a t_imm

(* CR layouts v1.5: the location on that message is wrong. But it's hard to
   improve, because it comes from re-checking typedtree, where we don't have
   locations any more. I conjecture the same location problem exists when
   constraints aren't satisfied. *)

(********************)
(* Test 5: newtypes *)

let f (type a : value mod mode) (x : a) = x

let f (type a : immediate mod mode) (x : a) = x

let f (type a : float64 mod mode) (x : a) = x

let f (type a : any mod mode) (x : a) = x

(****************************************)
(* Test 6: abstract universal variables *)

let f : type (a : value mod mode). a -> a = fun x -> x

let f : type (a : immediate mod mode). a -> a = fun x -> x

let f : type (a : float64 mod mode). a -> a = fun x -> x

let f : type (a : any mod mode). a -> a = fun x -> x

(**************************************************)
(* Test 7: Defaulting universal variable to value *)

module type S = sig
  val f : 'a. 'a t2_imm -> 'a t2_imm
end

let f : 'a. 'a t2_imm -> 'a t2_imm = fun x -> x

(********************************************)
(* Test 8: Annotation on universal variable *)

module type S = sig
  val f : ('a : value mod mode). 'a t2_imm -> 'a t2_imm
end

module type S = sig
  val f : 'a t2_imm -> 'a t2_imm

  val g : ('a : immediate mod mode). 'a t2_imm -> 'a t2_imm
end

module type S = sig
  val f : 'a t2_float64 -> 'a t2_float64

  val g : ('a : float64 mod mode). 'a t2_float64 -> 'a t2_float64
end

(************************************************************)
(* Test 9: Annotation on universal in polymorphic parameter *)

let f (x : ('a : immediate mod mode). 'a -> 'a) = x "string"

(**************************************)
(* Test 10: Parsing & pretty-printing *)

let f (type a : immediate mod mode) (x : a) = x

let f (type a : immediate mod mode) (x : a) = x

let f (type a : value mod mode) (x : a) = x

let o =
  object
    method m : type (a : immediate mod mode). a -> a = fun x -> x
  end

let f : type (a : immediate mod mode). a -> a = fun x -> x

let f x =
  let local_ g (type a : immediate mod mode) (x : a) = x in
  g x [@nontail]

let f x y (type a : immediate mod mode) (z : a) = z

let f x y (type a : immediate mod mode) (z : a) = z

external f : ('a : immediate mod mode). 'a -> 'a = "%identity"

type (_ : any mod mode) t2_any

exception
  E :
    ('a : immediate mod mode) ('b : any mod mode).
    'b t2_any * 'a list
    -> exn

let f (x : ('a : immediate mod mode). 'a -> 'a) = (x 3, x true)

type _ a = Mk : [> ] * ('a : immediate mod mode) -> int a

module type S = sig
  type _ a = Mk : [> ] * ('a : immediate mod mode) -> int a

  val f_imm : ('a : immediate mod mode) ('b : value mod mode). 'a -> 'a

  val f_val : ('a : value mod mode). 'a -> 'a

  type (_ : value) g = MkG : ('a : immediate mod mode). 'a g

  type t = int as (_ : immediate mod mode)
end

let f_imm : ('a : immediate mod mode). 'a -> 'a = fun x -> x

let f_val : ('a : value mod mode). 'a -> 'a = fun x -> f_imm x

type (_ : value mod mode) g = MkG : ('a : immediate mod mode). 'a g

type t = int as (_ : immediate mod mode)

type t = ('a : value mod mode, 'b : value mod mode) t2

type ('a, 'b) t = ('a : value mod mode) * ('b : value mod mode)

class c : object
  method m : ('a : immediate mod mode). 'a -> 'a

  val f : ('a : immediate mod mode) -> 'a
end =
  object
    method m : type (a : immediate mod mode). a -> a = fun x -> x

    val f = fun (x : ('a : immediate mod mode)) -> x
  end

type _ g = MkG : ('a : immediate mod mode) ('b : void mod mode). 'a -> 'b g

type ('a : void mod mode) t3 = ..

type _ t3 += MkG : ('a : immediate mod mode) 'b. 'a -> 'b t3

let f_gadt : ('a : value mod mode). 'a -> 'a g -> 'a = fun x MkG -> f_imm x

(* comments *)
val foo :
  ((* comment 1 *) 'k (* comment 2 *) :
  (* comment 3 *) immediate64 (* comment 4 *)) (* comment 5 *)
  'cmp.
     (module S
        with type Id_and_repr.t = 'k
         and type Id_and_repr.comparator_witness = 'cmp )
  -> 'k Jane_symbol.Map.t
  -> ('k, Sockaddr.t, 'cmp) Map.t

type a =
  b (* comment 0 *)
  as
  ((* comment 1 *)
  'k (* comment 2 *) :
  (* comment 3 *)
  immediate64
  (* comment 4 *)
  mod (* comment 5 *)
      mode
  (* comment 6 *))
(* comment 7 *)

let f (type a : immediate mod mode) x = x

let f
    (type (a : immediate mod mode) b c d e f g h i j k l m n o p q r s t u v
    w x y z ) x =
  x

let f (type (a : immediate mod mode) b) x = x

let f (type a (b : immediate mod mode)) x = x

let f (type (a : immediate mod mode) (b : immediate mod mode)) x = x

module type S = sig
  val init_with_immediates :
    ('a : immediate mod mode) ('b : immediate mod mode).
    int -> f:local_ (int -> local_ 'a) -> local_ 'a t
end

(**************************************)
(* Test 11: Arbitrary strings as layout names *)

type t_asdf : asdf mod mode

let x : int as ('a : some_layout mod mode) = 5

let f : ('a : alayout mod mode). 'a t -> 'a t = fun x -> x

let _ : _ =
  [%str
    let%lpoly rec fold (type (a : poly mod mode) acc) (xs : a list)
        ~(init : acc) ~f =
      match xs with [] -> init | x :: xs -> fold xs ~init:(f init x) ~f
    [@@layout (poly : value bits64), (acc : value bits64)]]

(**********************************************)
(* Test 12: annotated quantification in gadts *)

type t =
  | T :
      ('a : value mod mode) 'b ('c : float64 mod mode) 'd.
      'a * 'b * 'c * 'd
      -> t

type t =
  | T :
      ('a : value mod mode) 'b ('c : float64 mod mode) 'd.
      {x: 'a * 'b * 'c * 'd}
      -> t

type t =
  | T :
      ((* 1 *) 'a : value mod mode)
      'b
      (* 2 *)
      ('c : (* 3 *) float64 mod mode)
      'd.
      (* 4 *) 'a * 'b * 'c * 'd
      -> t

type t =
  | T :
      ((* 1 *) 'a : value mod mode)
      'b
      (* 2 *)
      ('c : (* 3 *) float64 (* 4 *) mod mode)
      'd.
      (* 5 *)
      
      {x: 'a * 'b * 'c * 'd}
      -> t
